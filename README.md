# Распознаем речь
Данный проект позволяет запускать ботов для 2-х платформ: `VK` и `Telegram`.
Боты обучены на платформе `DialogFlow`.

## Что необходимо для запуска
Для данного проекта необходим `Python3.6` (или выше).
Создадим виртуальное окружение в корневой директории проекта:
```
python3 -m venv env
```
После активации виртуального окружения установим необходимые зависимости:
```
pip install -r requirements.txt
```
Также заранее создадим файл `.env` в директории проекта.

Теперь нам потребуется авторизоваться на `DialogFlow` для того, чтобы подключить к платформе ботов.

* Первое, что нужно сделать - это создать проект на `Google Cloud` по [ссылке](https://console.cloud.google.com/home/dashboard)
* Второе, авторизуемся на [DialogFlow](https://dialogflow.cloud.google.com/#/login) и создаём нового `агента`. **ВАЖНО!!!** Ваш `агент` должен быть привязан к проекту на `Google Cloud`.
* Третье, установим и настроим `Google Cloud CLI`, для того чтобы получить заветный `json-файл` с данными, которые необходимы для авторизации через `Python-код`. Для этого выполняем поочередно пункты по этой [ссылке](https://cloud.google.com/docs/authentication/provide-credentials-adc#local-dev).
После команды `gcloud auth application-default login` вам будет доступен путь к вашему `json-файлу`, запишите его в файл `.env` 
```
GOOGLE_APPLICATION_CREDENTIALS=
```
Также запишите ваш id проекта `Google Cloud`
```
PROJECT_ID=
```
## Создаём ботов
В проекте используются 2 телеграм бота, первый бот основной, второй - необходим для сбора логов. Подберите соответствующие названия для них.
Для создания телеграм ботов напишите [отцу ботов](https://telegram.me/BotFather).

Запишите их токены в `.env`:
```
SPEECH_BOT_TELEGRAM_TOKEN=
ERROR_LOG_BOT_TOKEN=
```
Боту ошибок необходим ваш `телеграм id`, напишите [userinfobot](https://t.me/userinfobot) для его получения. Запишем его в `.env`:
```
PERSON_ID=
```
Для создания VK-бота для начала создадим группу, в которой уже потом запустим самого бота. В `управлении` созданной группы во вкладке `сообщения` убедимся, что сами сообщения включены, добавим их в левое меню и запишем преветствие.

Для получения `API токена` необходимо создать ключ во вкладке настроек `Работа с API`. Разрешим приложению `доступ к сообщениям сообщества`. Запишем токен в файл `.env`:
```
VK_GROUP_TOKEN=
```
## Тренируем DialogFlow
Для обучения бота в проекте есть файл `dialogflow_training.py`. Для запуска программы необходимо указать дополнительный аргумент `-f` и передать путь до файла с фразами, также можно не указывать аргумент, тогда скрипт будет искать файл с именем `questions.json` в той же папке, в которой лежит сам файл программы.

Пример запуска
```
python dialogflow_training.py -а ./questions.json
```

## Запуск ботов
Боты запускаются командами
```
python telegram_bot.py
python vk_bot.py 
```
При возникновении ошибок в любом из ботов, вы узнаете о них через бота журнала ошибок.